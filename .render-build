#!/bin/bash
set -e # Exit on any error

echo "ğŸ—ï¸ Starting build process..."

# The build command from render.yaml runs these commands:
# npm install && cd ../frontend && npm install && npm run build && cd ../backend && npm install

# Build the frontend first
echo "ğŸ”§ Building frontend..."
cd /opt/render/project/src/frontend
npm install
npm run build

# Verify build was successful
if [ -d "/opt/render/project/src/frontend/dist" ]; then
  echo "âœ… Frontend build completed successfully"
  ls -la /opt/render/project/src/frontend/dist
else
  echo "âŒ ERROR: Frontend build failed - dist directory not found"
  exit 1
fi

# Change back to backend directory - dependencies were already installed
cd /opt/render/project/src/backend

echo "âœ… Build process completed successfully"